<!DOCTYPE html>
<html>
<head>
  <base target="_top">
</head>
<body>
<!-- CDNから読み込み(http, https省いています) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.19/jquery-ui.min.js"></script>
<script src="https://js.cybozu.com/jqgrid/v5.1.1/js/jquery.jqGrid.min.js"></script>
<script src="https://js.cybozu.com/jqgrid/v5.1.1/js/i18n/grid.locale-en.js"></script>
<script src="https://js.cybozu.com/jqgrid/v5.1.1/js/i18n/grid.locale-ja.js"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.19/themes/redmond/jquery-ui.css">
<link rel="stylesheet" href="https://js.cybozu.com/jqgrid/v5.1.1/css/ui.jqgrid.css">


<style type="text/css">
/* jqGridのセル内を折り返しする */
.ui-jqgrid tr.jqgrow td {
  white-space: normal;
  word-break: break-all;
}
</style>



<script type="text/javascript">
var DEBUG = true;
//DEBUG = false;
$(document).ready(function(){
  if ( DEBUG === false ) {
    google.script.run.withSuccessHandler(loadToTable).readFromGoogleSheet();
  } else {
    var text = [
      ["001", "あいaaaaaaaaaaaaaaaaああああああ", "か"],
      ["002", "うえ", "きく"],
      ["003", "お", "けこ"],
    ];
    loadToTable(JSON.stringify(text));
  }
});

  
function loadToTable(rangeValuesJSON){
  var rangeValues = JSON.parse(rangeValuesJSON);
  var JQGRID_TITLE = "Data Table",
  DISP_ROW_MAX = 100,
  colArray = [],
  rowArray = [];
  
  colArray.push({"name":"id",     "label":"ID",  "sortable":true, "width": 100 });
  colArray.push({"name":"value0", "label":"1", "sortable":true, "width": 100 });
  colArray.push({"name":"value1", "label":"2", "sortable":true, "width": 100 ,"formatter":	fncLink});

  rowArray = rangeValues.map(function(t){
    return {"id":t[0], "value0":t[1], "value1":t[2] };
  });
    console.log(rowArray);

  
  jQuery("#jqGridList").jqGrid({
    data: rowArray,
    colModel: colArray,
    datatype: "local",
    sortorder: "ASC",
    multiselect: false,
    rowNum:DISP_ROW_MAX,
    excel: true,
    viewrecords: true,
    caption: JQGRID_TITLE
  });
}

function fncLink(cval, opt, rdt){
  var str = "<a href='http://www.google.com/?cd=" + cval + "' target='_blank'>" + cval + "</a>";
  return str;
}
</script>
        
<input type="button" value="Close" onclick="google.script.host.close()" />

<table id="jqGridList"> </table>


</body>
</html>


